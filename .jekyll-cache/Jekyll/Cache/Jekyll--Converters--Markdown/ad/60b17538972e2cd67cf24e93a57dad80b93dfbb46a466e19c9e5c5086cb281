I"<h1 id="hisatç®—æ³•åŸç†">Hisatç®—æ³•åŸç†</h1>

<p><img src="/Users/cooper/Desktop/%E6%96%87%E7%8C%AE/typora/science/image-20191115155030163.png" alt="image-20191115155030163" /></p>

<h1 id="ä¸€å»ºç«‹ç´¢å¼•">ä¸€ã€å»ºç«‹ç´¢å¼•</h1>

<p>å»ºç«‹åŸºå› ç»„ç´¢å¼•</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>#NCBI:
hisat2-build -p 4 GCF_000224145.3_KH_genomic (1).fna   hisat2_index/
</pre></td></tr></tbody></table></code></pre></div></div>

<p>å»ºç«‹åŸºå› ç»„+è½¬å½•ç»„+SNPç´¢å¼•ï¼š
bowtie2çš„ç´¢å¼•åªæœ‰åŸºå› ç»„åºåˆ—ä¿¡æ¯ï¼Œtophat2æ¯”å¯¹æ—¶ï¼Œè½¬å½•ç»„ä¿¡æ¯é€šè¿‡-Gå‚æ•°æŒ‡å®šã€‚HISAT2å»ºç«‹ç´¢å¼•æ—¶ï¼Œå°±åº”è¯¥æŠŠè½¬å½•ç»„ä¿¡æ¯åŠ è¿›å»ã€‚</p>

<h3 id="gffæ–‡ä»¶ä¸gtfæ–‡ä»¶">GFFæ–‡ä»¶ä¸GTFæ–‡ä»¶ï¼š</h3>

<p>GFF: general feature format</p>

<p>GTF: gene transfer format</p>

<p>ç®€ä»‹ï¼šhttps://www.jianshu.com/p/a27be34d335d</p>

<p>http://www.biotrainee.com/thread-415-1-1.html</p>

<p>å°†GFFæ–‡ä»¶è½¬æ¢æœªGTF</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>#å®‰è£…
conda install gffread -y
#ä½¿ç”¨
gffread GCF_000224145.3_KH_genomic\ \(1\).gff -T -o GCF_000224145.3_KH_genomic.gtf
#æ›´å¤šä½¿ç”¨æ–¹æ³•è¯·çœ‹ç½‘ç«™
</pre></td></tr></tbody></table></code></pre></div></div>

<p>HISAT2æä¾›ä¸¤ä¸ªPythonè„šæœ¬å°†GTFæ–‡ä»¶è½¬æ¢æˆhisat2-buildèƒ½ä½¿ç”¨çš„æ–‡ä»¶ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>hisat2_extract_exons.py *gtf &gt; GCF_000224145.3_KH_genomic.exon
hisat2_extract_splice_sites.py *gtf &gt; GCF_000224145.3_KH_genomic.ss
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æ­¤å¤–ï¼ŒHISAT2è¿˜æ”¯æŒå°†SNPä¿¡æ¯åŠ å…¥åˆ°ç´¢å¼•ä¸­ï¼Œè¿™æ ·æ¯”å¯¹çš„æ—¶å€™å°±å¯ä»¥è€ƒè™‘SNPçš„æƒ…å†µã€‚è¿™ä»ç„¶éœ€è¦å°†SNPæ–‡ä»¶è½¬æ¢æˆhisat2-buildèƒ½ä½¿ç”¨çš„æ–‡ä»¶ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>#è¿˜æœªçœ‹æ‡‚è¾“å…¥æ–‡ä»¶
</pre></td></tr></tbody></table></code></pre></div></div>

<p>å°†åŸºå› ç»„ã€è½¬å½•ç»„ã€SNPå»ºç«‹ç´¢å¼•ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>#è¿™é‡Œæœªå°†snpæ–‡ä»¶è¾“å…¥
hisat2-build -p 4 *fna --ss *ss --exon *exon hisat2_index_2/ciona_intestinalis_index
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="/Users/cooper/Desktop/%E6%96%87%E7%8C%AE/typora/science/image-20200305193830623.png" alt="image-20200305193830623" /></p>

<h1 id="äºŒæ¯”å¯¹">äºŒã€æ¯”å¯¹</h1>

<h4 id="usage">Usage:</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>hisat2 [options]* -x &lt;hisat2-idx&gt; {-1 &lt;m1&gt; -2 &lt;m2&gt; | -U &lt;r&gt; | --sra-acc &lt;SRA accession number&gt;} [-S &lt;hit&gt;]
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="é»˜è®¤å‚æ•°">é»˜è®¤å‚æ•°</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre>0-6/0_6_1.fq.gz -2 0-6/0_6_2.fq.gz  -S hisat2_results/0-6.sam

#è§£å‹åæ¯”å¯¹ï¼Œç»“æœè²Œä¼¼ä¸€æ ·
time hisat2 -p 4 -x ciona_intestinalis/NCBI/hisat2_index_2/ciona_intestinalis_index -1 0-6/0_6_1.fq -2 0-6/0_6_2.fq -S hisat2_results/deault_paramaters/0-6_gunzip.sam &gt; hisat2_results/deault_paramaters/logs 2&gt;&amp;1
#ç”¨æ—¶ï¼š
real	32m35.504s
user	101m19.816s
sys	8m12.721s

</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="for-sl-quant">for SL-quantï¼š</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre># 1) end-to-end (without soft-clipping)---in order to make sure that reads originating from trans-spliced RNA fragments do not map.This is the default behaviour of many mappers (bowtie2, tophat2, BBMap, â€¦) but for others, such as STAR or HiSAT2, soft-clipping should be disabled.

#æ¯”å¯¹
time hisat2 -p 4 --no-softclip --no-discordant --min-intronlen 20 --max-intronlen 5000 --rna-strandness FR -x ciona_intestinalis/NCBI/hisat2_index_2/ciona_intestinalis_index -1 0-6/0_6_1.fq -2 0-6/0_6_2.fq -S hisat2_results/SL_paramaters/0_6_.sam &gt; hisat2_results/SL_paramaters/logs 2&gt;&amp;1
#å‚æ•°
--no-softclip:
--min-mitronlen:
--max-intronlen
--rna-strandness

</pre></td></tr></tbody></table></code></pre></div></div>

<p>-p : threadsæ•°</p>

<p>-x :å‚è€ƒåŸºå› ç»„ç´¢å¼•æ–‡ä»¶çš„å‰ç¼€</p>

<p>-1 :åŒç«¯æµ‹åºç»“æœçš„ç¬¬ä¸€ä¸ªæ–‡ä»¶ã€‚è‹¥æœ‰å¤šç»„æ•°æ®ï¼Œä½¿ç”¨é€—å·å°†æ–‡ä»¶åˆ†éš”ã€‚Readsçš„é•¿åº¦å¯ä»¥ä¸ä¸€è‡´</p>

<p>-2 :åŒç«¯æµ‹åºç»“æœçš„ç¬¬äºŒä¸ªæ–‡ä»¶ã€‚è‹¥æœ‰å¤šç»„æ•°æ®ï¼Œä½¿ç”¨é€—å·å°†æ–‡ä»¶åˆ†éš”ï¼Œå¹¶ä¸”æ–‡ä»¶é¡ºåºè¦å’Œ-1å‚æ•°å¯¹åº”ã€‚Readsçš„é•¿åº¦å¯ä»¥ä¸ä¸€è‡´</p>

<p>-U :å•ç«¯æ•°æ®æ–‡ä»¶ã€‚è‹¥æœ‰å¤šç»„æ•°æ®ï¼Œä½¿ç”¨é€—å·å°†æ–‡ä»¶åˆ†éš”ã€‚å¯ä»¥å’Œ-1ã€-2å‚æ•°åŒæ—¶ä½¿ç”¨ã€‚Readsçš„é•¿åº¦å¯ä»¥ä¸ä¸€è‡´</p>

<p>â€“sra-acc :è¾“å…¥SRAç™»å½•å·ï¼Œæ¯”å¦‚SRR353653ï¼ŒSRR353654ã€‚å¤šç»„æ•°æ®ä¹‹é—´ä½¿ç”¨é€—å·åˆ†éš”ã€‚HISATå°†è‡ªåŠ¨ä¸‹è½½å¹¶è¯†åˆ«æ•°æ®ç±»å‹ï¼Œè¿›è¡Œæ¯”å¯¹</p>

<p>-S :æŒ‡å®šè¾“å‡ºçš„SAMæ–‡ä»¶</p>

<p>-q:è¾“å…¥æ–‡ä»¶ä¸ºFASTQæ ¼å¼ã€‚FASTQæ ¼å¼ä¸ºé»˜è®¤å‚æ•°</p>

<p>-f : è¾“å…¥æ–‡ä»¶ä¸ºFASTAæ ¼å¼</p>

<p>-r : è¾“å…¥æ–‡ä»¶ä¸­ï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€æ¡åºåˆ—ï¼Œæ²¡æœ‰åºåˆ—åå’Œæµ‹åºè´¨é‡ç­‰ã€‚é€‰æ‹©æ­¤é¡¹æ—¶ï¼Œâ€“ignore-qualså‚æ•°ä¹Ÿä¼šè¢«é€‰æ‹©</p>

<p>-c : æ­¤å‚æ•°åæ˜¯ç›´æ¥æ¯”å¯¹çš„åºåˆ—ï¼Œè€Œä¸æ˜¯åŒ…å«åºåˆ—çš„æ–‡ä»¶åã€‚åºåˆ—é—´ç”¨é€—å·éš”å¼€ã€‚é€‰æ‹©æ­¤é¡¹æ—¶ï¼Œâ€“ignore-qualså‚æ•°ä¹Ÿä¼šè¢«é€‰æ‹©</p>

<p>-s/â€“skip <int>
è·³è¿‡è¾“å…¥æ–‡ä»¶ä¸­å‰æ¡åºåˆ—è¿›è¡Œæ¯”å¯¹ã€‚
-u/â€“qupto <int>
åªä½¿ç”¨è¾“å…¥æ–‡ä»¶ä¸­å‰æ¡åºåˆ—è¿›è¡Œæ¯”å¯¹ï¼Œé»˜è®¤æ˜¯æ²¡æœ‰é™åˆ¶ã€‚
-5/â€“trim5 <int>
æ¯”å¯¹å‰å»é™¤æ¯æ¡åºåˆ—5â€™ç«¯ä¸ªç¢±åŸº
-3/â€“trim3 <int>
æ¯”å¯¹å‰å»é™¤æ¯æ¡åºåˆ—3â€™ç«¯ä¸ªç¢±åŸº
â€“phred33
è¾“å…¥çš„FASTQæ–‡ä»¶ç¢±åŸºè´¨é‡å€¼ç¼–ç æ ‡å‡†ä¸ºphred33ï¼Œphred33ä¸ºé»˜è®¤å‚æ•°ã€‚
â€“phred64
è¾“å…¥çš„FASTQæ–‡ä»¶ç¢±åŸºè´¨é‡å€¼ç¼–ç æ ‡å‡†ä¸ºphred64ã€‚
â€“solexa-quals
å°†Solexaçš„ç¢±åŸºè´¨é‡å€¼ç¼–ç æ ‡å‡†è½¬æ¢ä¸ºphredã€‚
â€“int-quals</int></int></int></int></p>

<h3 id="question">Question:</h3>

<ol>
  <li>æ¯”è¾ƒä¸€ä¸‹ç›´æ¥ç”¨genome.fa ä¸å¤šç§æ•°æ®å»ºç«‹çš„indexï¼Œæ¯”å¯¹çš„ç»“æœæœ‰ä½•åŒºåˆ«ï¼Ÿ</li>
</ol>

:ET