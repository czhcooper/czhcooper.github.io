I"1<h1 id="æ•™ç¨‹">æ•™ç¨‹ï¼š</h1>

<p><a href="/Users/cooper/Desktop/è½¬å½•ç»„/RNA-seq overview/Trinity protoocl.pdf">Nature protoocl</a></p>

<p><a href="https://github.com/trinityrnaseq/trinityrnaseq/wiki/Trinity-Differential-Expression">Trinity tutorial github</a></p>

<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3571712/">Trinity software paper</a></p>

<h2 id="ä¸ºä»€ä¹ˆè¦de-novo">ä¸ºä»€ä¹ˆè¦de novoï¼Ÿï¼š</h2>

<p><strong>Genome-guided assembly</strong> VS   <strong>De novo assembly</strong>?</p>

<p>1.ç¼ºä¹é«˜è´¨é‡å‚è€ƒåŸºå› ç»„ï¼Œ</p>

<p>2.RNA-seq å¯ä»¥æ³¨é‡Šè½¬å½•åŸºå› å’Œå¤–æ˜¾å­ç»“æ„</p>

<p>Genomic DNA assembly: one locus-one contig</p>

<p>Transcriptome : one contig per distinct transcript(isoform) rather than per locus;and different transcripts will have different coverage, reflecting their different expression levels.</p>

<p>å®‰è£…ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>conda create -n Trinity Trinity -y
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ä½¿ç”¨ï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre> Trinity --seqType fq --max_memory 50G --left reads_1.fq  --right reads_2.fq --CPU 6 --jaccard_clip
</pre></td></tr></tbody></table></code></pre></div></div>

<p>å‚æ•°è¯´æ˜ï¼š</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
</pre></td><td class="rouge-code"><pre>å¿…é¡»çš„å‚æ•°ï¼š
--seqType     readsçš„ç±»å‹ï¼š(cfa, cfq, fa, or fq)
--JM          jellyfishä½¿ç”¨å¤šå°‘Gå†…å­˜ç”¨æ¥è¿›è¡Œk-merçš„è®¡ç®—ï¼ŒåŒ…å«â€˜Gâ€™è¿™ä¸ªå­—ç¬¦
--left        å·¦è¾¹çš„readsçš„æ–‡ä»¶å
--rigth       å³è¾¹çš„readsçš„æ–‡ä»¶å
--single      ä¸æˆå¯¹çš„readsçš„æ–‡ä»¶å

å¯é€‰å‚æ•°ï¼š

Miscï¼š
--SS_lib_type        readsçš„æ–¹å‘ã€‚æˆå¯¹çš„reads: RF or FR; ä¸æˆå¯¹çš„reads
: F or Rã€‚åœ¨æ•°æ®å…·æœ‰é“¾ç‰¹å¼‚æ€§çš„æ—¶å€™ï¼Œè®¾ç½®æ­¤å‚æ•°ï¼Œåˆ™æ­£ä¹‰å’Œåä¹‰è½¬å½•å­èƒ½å¾—åˆ°åŒºåˆ†ã€‚é»˜è®¤
æƒ…å†µä¸‹ï¼Œä¸è®¾ç½®æ­¤å‚æ•°ï¼Œreadsè¢«å½“ä½œéé“¾ç‰¹å¼‚æ€§å¤„ç†ã€‚FR: åŒ¹é…æ—¶ï¼Œread1åœ¨5'ç«¯ä¸Šæ¸¸, 
å’Œå‰å¯¼é“¾ä¸€è‡´, read2åœ¨3'ä¸‹æ¸¸, å’Œå‰å¯¼é“¾åå‘äº’è¡¥. æˆ–è€…read2åœ¨ä¸Šæ¸¸, read1åœ¨ä¸‹æ¸¸å
å‘äº’è¡¥; RF: read1åœ¨5'ç«¯ä¸Šæ¸¸, å’Œå‰å¯¼é“¾åå‘äº’è¡¥, read2åœ¨3'ç«¯ä¸‹æ¸¸, å’Œå‰å¯¼é“¾ä¸€è‡´;
--output             è¾“å‡ºç»“æœæ–‡ä»¶å¤¹ã€‚é»˜è®¤æƒ…å†µä¸‹ç”Ÿæˆtrinity_out_diræ–‡ä»¶å¤¹å¹¶
å°†è¾“å‡ºç»“æœä¿å­˜åˆ°æ­¤æ–‡ä»¶å¤¹ä¸­ã€‚
--CPU                ä½¿ç”¨çš„CPUçº¿ç¨‹æ•°ï¼Œé»˜è®¤ä¸º2
--min_contig_length  æŠ¥å‘Šå‡ºçš„æœ€çŸ­çš„contigé•¿åº¦ã€‚é»˜è®¤ä¸º200
--jaccard_clip       å¦‚æœä¸¤ä¸ªè½¬å½•å­ä¹‹é—´æœ‰UTRåŒºé‡å ï¼Œåˆ™è¿™ä¸¤ä¸ªè½¬å½•å­å¾ˆæœ‰å¯èƒ½åœ¨
de novoç»„è£…çš„æ—¶å€™è¢«æ‹¼æ¥æˆä¸€æ¡åºåˆ—ï¼Œç§°ä¸ºèåˆè½¬å½•å­(Fusion Transcript)ã€‚å¦‚æœæœ‰
fastqæ ¼å¼çš„paired readsï¼Œå¹¶å°½å¯èƒ½å‡å°‘æ­¤ç±»ç»„è£…é”™è¯¯ï¼Œåˆ™é€‰ç”¨æ­¤å‚æ•°ã€‚å€¼å¾—è¯´æ˜çš„æ˜¯ï¼š
1. é€‚åˆäºåŸºå› åœ¨åŸºå› ç»„æ¯”è¾ƒç¨ å¯†ï¼Œè½¬å½•å­ç»å¸¸åœ¨UTRåŒºåŸŸé‡å çš„ç‰©ç§ï¼Œæ¯”å¦‚çœŸèŒåŸºå› ç»„ã€‚è€Œå¯¹
äºè„Šæ¤åŠ¨ç‰©å’Œæ¤ç‰©ï¼Œåˆ™ä¸æ¨èä½¿ç”¨æ­¤å‚æ•°; 2. è¦æ±‚fastqæ ¼å¼çš„paired readsæ–‡ä»¶(æ–‡ä»¶
ä¸­readsååˆ†åˆ«ä»¥/1å’Œ/2ç»“å°¾ï¼Œä»¥åˆ©äºè½¯ä»¶è¯†åˆ«)ï¼ŒåŒæ—¶è¿˜éœ€è¦å®‰è£…bowtieè½¯ä»¶ç”¨äºreads
çš„æ¯”å¯¹; 3. å•ç‹¬ä½¿ç”¨å…·æœ‰é“¾ç‰¹å¼‚æ€§çš„RNA-seqæ•°æ®çš„æ—¶å€™ï¼Œèƒ½æå¤§åœ°å‡å°‘UTRé‡å åŒºå¾ˆå°çš„
èåˆè½¬å½•å­; 4. æ­¤é€‰é¡¹è€—è´¹è¿ç®—ï¼Œè‹¥æ²¡å¿…è¦ï¼Œåˆ™ä¸ç”¨æ­¤å‚æ•°ã€‚
--prep               ä»…ä»…å‡†å¤‡ä¸€äº›æ–‡ä»¶(åˆ©äºI/Oï¼‰å¹¶åœ¨kmerè®¡ç®—å‰åœæ­¢ç¨‹åºè¿è¡Œ
--no_cleanup         ä¿ç•™æ‰€æœ‰çš„ä¸­é—´è¾“å…¥æ–‡ä»¶
--full_cleanup       ä»…ä¿ç•™Trinity fastaæ–‡ä»¶ï¼Œå¹¶é‡å‘½åæˆ${output_dir}.
Trinity.fasta
--cite               æ˜¾ç¤ºTrinityæ–‡çŒ®å¼•è¯å’Œä¸€äº›å‚ä¸çš„è½¯ä»¶å·¥å…·
--version            æŠ¥å‘ŠTrinityç‰ˆæœ¬å¹¶æ¨å‡º

Inchworm å’Œ K-mer è®¡ç®—ç›¸å…³é€‰é¡¹ï¼š
--min_kmer_cov      ä½¿ç”¨Inchwormæ¥è®¡ç®—K-meræ•°é‡æ—¶å€™ï¼Œè®¾ç½®çš„Kmerçš„æœ€å°å€¼ã€‚
é»˜è®¤ä¸º1
--inchworm_cpu      Inchwormä½¿ç”¨çš„CPUçº¿ç¨‹æ•°ï¼Œé»˜è®¤ä¸º6å’Œ--CPUè®¾ç½®çš„å€¼ä¸­çš„
å°å€¼ã€‚

Chrysalisç›¸å…³é€‰é¡¹ï¼š
--max_reads_per_graph   åœ¨ä¸€ä¸ªBruijnå›¾ä¸­é”šå®šçš„æœ€å¤§çš„readsæ•°ç›®ï¼Œé»˜è®¤ä¸º200
000
--no_run_chrysalis      è¿è¡ŒInchwormå®Œæ¯•ï¼Œåœ¨è¿è¡Œchrysalisä¹‹å‰åœæ­¢è¿è¡Œ
Trinity
--no_run_quantifygraph  åœ¨å¹³è¡ŒåŒ–è¿ç®—quantifygrahpå‰åœæ­¢è¿è¡ŒTrinity

Butterflyç›¸å…³é€‰é¡¹ï¼š
--bfly_opts                    Butterflyé¢å¤–çš„å‚æ•°
--max_number_of_paths_per_node ä»node A -&gt; B,æœ€å¤šå…è®¸å¤šå°‘æ¡è·¯å¾„ã€‚é»˜è®¤
ä¸º10
--group_pairs_distance         æœ€å¤§æ’å…¥ç‰‡è¯»é•¿åº¦ï¼Œé»˜è®¤ä¸º500
--path_reinforcement_distance  å»¶é•¿è½¬å½•å­è·¯å¾„æ—¶å€™ï¼Œreadsé—´æœ€å°çš„é‡å ç¢±åŸº
æ•°ã€‚é»˜è®¤PE:75; SEï¼š25
--no_triplet_lock              ä¸é”å®štriplet-supported nodes
--bflyHeapSpaceMax             è¿è¡ŒButterflyæ—¶javaæœ€å¤§çš„å †ç§¯ç©ºé—´ï¼Œé»˜è®¤
ä¸º20G
--bflyHeapSpaceInit            javaåˆå§‹çš„å †ç§¯ç©ºé—´ï¼Œé»˜è®¤ä¸º1G
--bflyGCThreads                javaè¿›è¡Œæ— ç”¨ä¿¡æ¯çš„æ•´ç†æ—¶ä½¿ç”¨çš„çº¿ç¨‹æ•°ï¼Œé»˜
è®¤ç”±javaæ¥å†³å®š
--bflyCPU                      è¿è¡ŒButterflyæ—¶ä½¿ç”¨çš„CPUçº¿ç¨‹æ•°ï¼Œé»˜è®¤ä¸º2
--bflyCalculateCPU             è®¡ç®—Butterflyæ‰€è¿è¡Œçš„CPUçº¿ç¨‹æ•°ï¼Œç”±å…¬å¼
 80% * max_memory / maxbflyHeapSpaceMax å¾—åˆ°
--no_run_butterfly             åœ¨Chrysalisè¿è¡Œå®Œæ¯•åï¼Œåœæ­¢è¿è¡ŒButterfly

Grid-computingé€‰é¡¹ï¼š
--grid_computing_module   é€‰å®šPerlæ¨¡å—ï¼Œåœ¨/Users/bhaas/SVN/trinityr
naseq/trunk/PerlLibAdaptors/ã€‚
</pre></td></tr></tbody></table></code></pre></div></div>

<h1 id="results">resultsï¼š</h1>

<p><img src="/img/md-post/image-20200229210458849.png" alt="image-20200229210458849" /></p>

<h2 id="è¯„ä¼°ç»„è£…è´¨é‡">è¯„ä¼°ç»„è£…è´¨é‡ï¼š</h2>

<h3 id="1rna-seq-read-representation-by-trinity-assembly">1.RNA Seq Read Representation by Trinity Assembly</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>bowtie2-build Trinity.fasta Trinity.fasta
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>bowtie2 -p 30  -q --no-unal -k 20 -x Trinity.fasta -1 ../C1_1_1.fq -2 ../C1_1_2.fq  2&gt;align_stats.txt| samtools view -@30 -Sb -o bowtie2.bam &amp;
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre>30251890 reads; of these:
  30251890 (100.00%) were paired; of these:
    6978680 (23.07%) aligned concordantly 0 times
    1325558 (4.38%) aligned concordantly exactly 1 time
    21947652 (72.55%) aligned concordantly &gt;1 times
    ----
    6978680 pairs aligned concordantly 0 times; of these:
      199258 (2.86%) aligned discordantly 1 time
    ----
    6779422 pairs aligned 0 times concordantly or discordantly; of these:
      13558844 mates make up the pairs; of these:
        1267412 (9.35%) aligned 0 times
        243382 (1.80%) aligned exactly 1 time
        12048050 (88.86%) aligned &gt;1 times
97.91% overall alignment rate
</pre></td></tr></tbody></table></code></pre></div></div>

<p>æ¯”å¯¹ç‡å¤§äº80%ã€‚</p>

<h3 id="2full-length-transcript-analysis-for-model-and-non-model-organisms-using-blast">2.Full-length transcript analysis for model and non-model organisms using BLAST+</h3>

<p>å¯¹å…¨é•¿è½¬å½•æœ¬è¯„ä¼°å¯ä»ä¸‰æ–¹é¢ï¼š</p>

<p>1.align the assembled transcripts to the <strong>reference transcripts</strong> and examine the length coverage.</p>

<p>2.or non-model organisms, no such reference transcript set is available. If a high quality annotation exists for a closely related organism, then one might compare the assembled transcripts to that <strong>closely related transcriptome</strong> to examine full-length coverage.</p>

<p>3.In other cases, a more general analysis to perform is to align the assembled transcripts against <strong>all known proteins</strong> and to determine the number of unique top matching proteins that align across more than X% of its length.</p>

<p>æ“ä½œï¼š</p>

<p>1.ä» <a href="https://www.aniseed.cnrs.fr/aniseed/download/download_data"><strong>ANiseed</strong></a>  ä¸‹è½½ <em>C.savignyi</em> çš„ Transcript Modelsï¼š</p>

<p><img src="/img/md-post/image-20200301004658103.png" alt="image-20200301004658103" /></p>

<p>ä¸ºä»€ä¹ˆæ˜¯proteinï¼Ÿ</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>æœåŠ¡å™¨æ–‡ä»¶ä½ç½®ï¼š~/data/clean_data/trinity_out_dir/protein_data
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>makeblastdb -in Ciona_savignyi.CSAV2.0.81_pep.2018.fa -dbtype prot

blastx -query trinity_out_dir.Trinity.fasta -db protein_data/Ciona_savignyi.CSAV2.0.81_pep.2018.fa -out blastx.outfmt6 -evalue 1e-20 -num_threads 20 -max_target_seqs 1 -outfmt 6
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>analyze_blastPlus_topHit_coverage.pl blastx.outfmt6 trinity_out_dir.Trinity.fasta protein_data/Ciona_savignyi.CSAV2.0.81_pep.2018.fa 
</pre></td></tr></tbody></table></code></pre></div></div>

<p>ç»“æœï¼š</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>#hit_pct_cov_bin	count_in_bin	&gt;bin_below
100	8770	8770
90	815	9585
80	724	10309
70	711	11020
60	741	11761
50	839	12600
40	910	13510
30	1078	14588
20	1317	15905
10	691	16596
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="busco">BuSCO</h3>

<p>å‚è€ƒï¼šhttps://busco.ezlab.org/busco_userguide.html</p>

<p>ç®€ä¹¦ï¼šhttps://www.jianshu.com/p/5041460f7a5d</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>busco -m MODE -i INPUT -o OUTPUT -l LINEAGE
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="/img/md-post/image-20200303192341715.png" alt="image-20200303192341715" /></p>

<p><img src="/img/md-post/image-20200303181803710.png" alt="image-20200303181803710" /></p>

<p><img src="/img/md-post/image-20200303192709631.png" alt="image-20200303192709631" /></p>

<h2 id="ä¸‹æ¸¸åˆ†æ">ä¸‹æ¸¸åˆ†æ</h2>

<h3 id="åŸºäºæ¯”å¯¹">åŸºäºæ¯”å¯¹</h3>

<h4 id="rsem">rsem</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>align_and_estimate_abundance.pl --transcripts trinity_out_dir.Trinity.fasta --seqType fq --samples_file ../samples_trinity.txt --est_method RSEM --output_dir transcript_quant --thread_count 54 --trinity_mode --aln_method bowtie2 --prep_reference
</pre></td></tr></tbody></table></code></pre></div></div>

:ET